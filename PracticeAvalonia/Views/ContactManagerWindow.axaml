<Window
    RequestedThemeVariant="Dark"
    Title="ContactManagerWindow"
    d:DesignHeight="650"
    d:DesignWidth="800"
    mc:Ignorable="d"
    x:Class="PracticeAvalonia.Views.ContactManagerWindow"
    x:DataType="vm:ContactManagerViewModel"
    xmlns="https://github.com/avaloniaui"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="using:PracticeAvalonia.ViewModels"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Design.DataContext>
        <vm:ContactManagerViewModel />
    </Design.DataContext>

    <Grid Margin="20" RowDefinitions="Auto, *">
        <StackPanel Margin="0,0,0,20">
            <TextBlock
                FontSize="24"
                FontWeight="Bold"
                HorizontalAlignment="Center"
                Margin="0,0,0,20"
                Text="Contact Manager" />
            <TextBox
                HorizontalAlignment="Center"
                Text="{Binding SearchText}"
                Watermark="Search contacts..."
                Width="300" />
        </StackPanel>

        <Grid ColumnDefinitions="2*, 1.5*" Grid.Row="1">
            <Border
                BorderBrush="Gray"
                BorderThickness="1"
                CornerRadius="5"
                Grid.Column="0"
                Padding="10">
                <Grid RowDefinitions="Auto,*">
                    <TextBlock
                        FontSize="18"
                        FontWeight="SemiBold"
                        Grid.Row="0"
                        Margin="0,0,0,10"
                        Text="Contacts" />
                    <ListBox
                        Background="Transparent"
                        Grid.Row="1"
                        ItemsSource="{Binding FilteredContacts}"
                        SelectedItem="{Binding SelectedContact}">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Margin="0,2" Padding="10">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <Border
                                            BorderBrush="LightGray"
                                            BorderThickness="0,0,0,1"
                                            Grid.ColumnSpan="2">
                                            <StackPanel>
                                                <TextBlock
                                                    FontSize="14"
                                                    FontWeight="Bold"
                                                    Text="{Binding Name}" />
                                                <TextBlock
                                                    FontSize="12"
                                                    Foreground="CornflowerBlue"
                                                    Text="{Binding Email}" />
                                                <TextBlock
                                                    FontSize="12"
                                                    Foreground="LimeGreen"
                                                    Text="{Binding Phone}" />
                                            </StackPanel>
                                        </Border>
                                        <Grid Grid.Column="1" VerticalAlignment="Top">
                                            <Button
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Command="{Binding $parent[ListBox].((vm:ContactManagerViewModel)DataContext).DeleteContactCommand}"
                                                CommandParameter="{Binding}"
                                                Content="🗑️"
                                                FontSize="16"
                                                Foreground="Red" />
                                        </Grid>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </Border>

            <ScrollViewer Grid.Column="1">
                <StackPanel>
                    <Border
                        BorderBrush="Gray"
                        BorderThickness="1"
                        CornerRadius="5"
                        Grid.Column="2"
                        Margin="10,0,0,0"
                        Padding="20">
                        <StackPanel>
                            <TextBlock
                                FontSize="18"
                                FontWeight="SemiBold"
                                HorizontalAlignment="Center"
                                Margin="0,0,0,20"
                                Text="Add New Contact" />
                            <TextBlock
                                FontWeight="SemiBold"
                                Margin="0,0,0,5"
                                Text="Name" />
                            <TextBox
                                Margin="0,0,0,15"
                                Text="{Binding NewName}"
                                Watermark="Enter full name" />
                            <TextBlock
                                FontWeight="SemiBold"
                                Margin="0,0,0,5"
                                Text="Email" />
                            <TextBox
                                Margin="0,0,0,15"
                                Text="{Binding NewEmail}"
                                Watermark="Enter email address" />
                            <TextBlock
                                FontWeight="SemiBold"
                                Margin="0,0,0,5"
                                Text="Phone" />
                            <TextBox
                                Margin="0,0,0,15"
                                Text="{Binding NewPhone}"
                                Watermark="Enter phone number" />

                            <Button
                                Command="{Binding AddContactCommand}"
                                Content="Add Contact"
                                FontSize="14"
                                FontWeight="SemiBold"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Center"
                                Padding="0,10" />

                            <TextBlock
                                FontSize="12"
                                FontStyle="Italic"
                                Foreground="Gray"
                                HorizontalAlignment="Center"
                                Margin="0,10,0,0"
                                Text="* Required fields" />

                            <Border
                                Background="DimGray"
                                CornerRadius="5"
                                Margin="0,20,0,0"
                                Padding="10">

                                <TextBlock HorizontalAlignment="Center">
                                    <Run Text="Total Contacts: " />
                                    <Run FontWeight="Bold" Text="{Binding Contacts.Count}" />
                                </TextBlock>
                            </Border>

                            <Border
                                Background="Gray"
                                CornerRadius="5"
                                IsVisible="{Binding SelectedContact, Converter={x:Static ObjectConverters.IsNotNull}}"
                                Margin="0,10,0,0"
                                Padding="10">
                                <StackPanel>
                                    <TextBlock
                                        FontWeight="SemiBold"
                                        Margin="0,0,0,5"
                                        Text="Selected Contact:" />
                                    <TextBlock FontWeight="Bold" Text="{Binding SelectedContact.Name}" />
                                    <TextBlock Text="{Binding SelectedContact.Email}" />
                                    <TextBlock Text="{Binding SelectedContact.Phone}" />
                                </StackPanel>
                            </Border>

                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Grid>

    </Grid>

</Window>
